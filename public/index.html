<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Цены токенов</title>
<style>
  body { font-family: Arial, sans-serif; background: #f8f9fa; padding: 30px; }
  table { border-collapse: collapse; width: 100%; max-width: 600px; margin: auto; }
  th, td { border: 1px solid #ccc; padding: 8px; text-align: center; }
  th { background: #2c3e50; color: white; }
</style>
</head>
<body>
<h1>Цены токенов</h1>
<table>
  <thead>
    <tr>
      <th>Токен</th>
      <th>ODOS (USDT)</th>
      <th>MEXC (USDT)</th>
      <th>Спред (%)</th>
    </tr>
  </thead>
  <tbody id="tokens-table">
    <tr><td>NAKA</td><td id="NAKA-odos">–</td><td id="NAKA-mexc">–</td><td id="NAKA-spread">–</td></tr>
    <tr><td>SAND</td><td id="SAND-odos">–</td><td id="SAND-mexc">–</td><td id="SAND-spread">–</td></tr>
    <tr><td>NWS</td><td id="NWS-odos">–</td><td id="NWS-mexc">–</td><td id="NWS-spread">–</td></tr>
  </tbody>
</table>

<script>
async function updatePrices() {
  try {
    const res = await fetch("/prices");
    const data = await res.json();

    for (const symbol of ["NAKA","SAND","NWS"]) {
      const odos = data.odos[symbol];
      const mexc = data.mexc[symbol];
      const spread = data.spread[symbol];

      document.getElementById(symbol + "-odos").textContent = odos !== null ? odos.toFixed(6) : "–";
      document.getElementById(symbol + "-mexc").textContent = mexc !== null ? mexc.toFixed(6) : "–";
      document.getElementById(symbol + "-spread").textContent = spread !== null ? spread.toFixed(2) : "–";
    }
  } catch (e) {
    console.error("Ошибка загрузки:", e);
  }
}

// Обновляем каждые 15 секунд
updatePrices();
setInterval(updatePrices, 15000);
</script>
</body>
</html>
